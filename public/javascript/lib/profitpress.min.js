/*! profitpress 2014-01-14 08:01:08 */
function unnest(a,b,c,d){"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=""),"undefined"==typeof d&&(d=[]);a[b];return"["===a[b]||"]"===a[b]?(c.length>0&&d.push(c),c=""):c+=a[b],"undefined"!=typeof a[b]?(b++,unnest(a,b,c,d)):d}function addCheckbox(a){var b=$("[data-checkbox-name]").first(),c=(b.parent(),"category["+a+"]"),d=b.clone(),e=d.find("input").clone();d.attr("data-checkbox-name",c),e.attr("name",c).prop("checked",!0),e.appendTo(d.find("label").empty()),d.find("label").append(a),d.appendTo(b.parent())}function addNewMeta(){var a=$("[head-description]").first();a.clone().html(""),a.appendTo(a.parent())}function ajaxPost(a,b){$.post(a,b,function(){},"json")}function sync(a,b){var c=$(a),d=c.val(),e=$(b);return"true"===e.attr("data-copy-html")&&(d=c.html(),syncScrollPostion(c,e)),"true"===e.attr("data-update-scrollbar"),"false"==e.attr("data-update")?!1:("true"===e.attr("data-copy-linkify")?(e.val(linkify(d)),e.html(linkify(d))):(e.val(d),e.html(d)),void 0)}function linkify(a){var b=a.replace(/([^a-zA-Z0-9])+|[\-\_]+/gi,"-").toLowerCase();return b.replace(/^[^a-zA-Z0-9]|[^a-zA-Z0-9]$/gi,"")}function copySourceToTarget(a,b){var c=$(b).attr("data-copy-target"),d='[data-copy-source="'+c+'"]';$(d).on("change input",function(){sync(d,b),$(b).trigger("change")})}function copyTargetToSource(a,b){var c=$(b),d=$(c).attr("data-copy-iframe-source"),e=$('[data-copy-iframe-target="'+d+'"]');$(c).on("DOMSubtreeModified MutationEvent DOMAttrModified",function(){sync(c,e,!0)})}function syncHeight(a,b){var c=$(a),d=$(b),e=c.height();d.animate({height:e})}function syncScrollPostion(a,b){var c=$(a),d=$(b),e=c[0].scrollHeight,f=c.scrollTop(),g=d[0].scrollHeight,h=(d.scrollTop(),f/e*g);b.scrollTop(h)}function markDownInit(){$("[data-markdown-source]").each(function(a,b){$(b).on("load change input",function(){var a=$(this),b=$('[data-markdown-target="'+a.attr("data-markdown-source")+'"]');markDown(a,b)}),$(b).trigger("load")})}function markDown(a,b){var c=new Showdown.converter,d=c.makeHtml(a.val());b.val(d),b.html(d)}$(document).ready(function(){$('[data-role="advanced-options-toggle"]').click(function(){$(this).hasClass("btn-default")?($(this).removeClass("btn-default"),$(this).addClass("btn-warning")):($(this).removeClass("btn-warning"),$(this).addClass("btn-default")),$(this).blur(),$('[data-role="advanced-options"]').toggleClass("hidden",100)}),$("[data-meta-copy]").each(function(){target=$(this).attr("data-meta-copy"),that=this,$('[name="'+target+'"]').keyup(function(){innerHtml=$(this).val(),$(that).html(innerHtml)})})}),$('[data-toggle-section="true"]').click(function(a){a.preventDefault(),$(this).tab("show")}),$(document).ready(function(){$("[data-ajax-route]").each(function(){console.log($(this)),$(this).on("click",function(){var a=$(this).attr("data-ajax-input"),b=$('[name="'+a+'"]').val();$.ajax({type:"POST",url:$(this).attr("data-ajax-route"),data:{value:b}}).done(function(a){addCheckbox(a.name)})})})}),function(a){a.widget("ProfitPress.ajax-form",{options:{dataRoute:"data-ajax-post-route",dataElement:"data-ajax-post-element"},_create:function(){this._bind()},_bind:function(){a(document).on("click",this.options.dataRoute,function(){var b=a(this).data(this.options.dataRoute),c=a(this).data(this.options.dataElement).val(),d={value:c};this.ajaxPost(b,d)})},ajaxPost:function(b,c){a.post(b,c,function(a,b,c){console.log(a),console.log(b),console.log(c)},"json")},HTTP200:function(){},HTTP409:function(){}})}(jQuery),yepnope({test:Modernizr.inputtypes&&Modernizr.inputtypes.date,nope:["javascript/vendor/date-timepicker/jquery.datetimepicker.css","javascript/vendor/date-timepicker/jquery.datetimepicker.js"]}),new Dropzone(document.body,{url:"/posts/fileupload",previewsContainer:"#previews",clickable:"#clickable",init:function(){this.on("error",function(a,b){alert(b)}),this.on("success",function(a,b){for(var c=document.getElementById("prerendered_content"),d=(c.value,b.length-1);d>=0;d--)c.value+="\n"+b[d].markdown,$(c).trigger("change")})}}),$(document).ready(function(){for(var a=($("#wrap"),$('[data-iframe="full-height"]')),b=$("#wrap > *").not(a),c=$("body").height(),d=b.length-1;d>=0;d--)c-=$(b[d]).height();a.height(c)}),$(document).ready(function(){$("[data-copy-target]").each(function(a,b){copySourceToTarget(a,b)})}),$(document).ready(function(){var a=window.location.hash.substring(1);a&&$('[href="'+a+'"]').trigger("click")}),$(document).ready(function(){$("[data-copy-input]").each(function(a,b){$(b).click(function(){var a=$(this).attr("data-copy-input");console.log(a),console.log($('input[name="'+a+'"]')),$('input[name="'+a+'"]').trigger("change")})}),markDownInit()});